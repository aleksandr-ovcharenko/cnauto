{% extends 'admin/base.html' %}

{% block head_css %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
{% endblock %}

{% block body %}
<div class="admin-header">
    <a href="/" class="admin-logo" style="margin-right: 10px;">
        <img src="{{ url_for('static', filename='images/site/main_logo.webp') }}" alt="CN-Auto" style="height: 40px; width: auto;">
    </a>
    {% if current_user.is_authenticated %}
    <div class="admin-user-info">
        {{ current_user.username }}
        {% for role in current_user.roles %}
        <span class="role-badge">роль: {{ role.name }}</span>
        {% endfor %}
        |
        <a href="{{ url_for('admin_logout') }}">Выйти</a>
    </div>
    {% endif %}
</div>
{{ super() }}
{% endblock %}

{% block extra_js %}
{{ super() }}
{% endblock %}

{% block tail %}
{{ super() }}
<script src="{{ url_for('static', filename='admin-scripts.js') }}"></script>
<script>
    // Add target="_blank" and external-link icon to specific admin tools
    document.addEventListener('DOMContentLoaded', function() {
        const menuItems = document.querySelectorAll('.nav-item');
        menuItems.forEach(item => {
            const link = item.querySelector('a');
            if (link && (
                link.textContent.includes('Логи') || 
                link.textContent.includes('API Документация')
            )) {
                link.setAttribute('target', '_blank');
                link.setAttribute('rel', 'noopener noreferrer');
                if (!link.querySelector('.bi-box-arrow-up-right')) {
                    const icon = document.createElement('i');
                    icon.className = 'bi bi-box-arrow-up-right';
                    icon.style.fontSize = '1em';
                    icon.style.verticalAlign = 'middle';
                    icon.style.marginLeft = '4px';
                    link.appendChild(icon);
                }
            }
        });
    });
</script>
{% endblock %}
